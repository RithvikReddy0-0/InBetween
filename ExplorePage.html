<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Nearby Places</title>
    <link rel="icon" href="Logo1.png" type="image/png">

    <link href="https://db.onlinewebfonts.com/c/20e9fce1ca54ce1d7b7a7329de9bdaef?family=Gistesy" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script type="module" src="https://cdn.jsdelivr.net/npm/@bufferhead/nightowl@0.0.14/dist/nightowl.js"></script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="AlertBoxCSS.css">
    <script src="Navigation.js"></script>
    <link rel="stylesheet" href="HeaderCSS.css">
    <link rel="stylesheet" href="FooterCSS.css">
    <link rel="stylesheet" href="navstyle.css">
    <script src="profilePhoto.js"></script>

    <style>
        body{
            color: #754f33;
            background-color: #ebdcd1;
        }
        #radius{
            margin:5px 10px;
            width: calc(100% - 20px); 
            background-color: #654528;

        }
        #values{
            margin: 10px 15px ;
        }
        .text-field-containerS {
            position: relative;
            width: 450px;
            margin: 10px auto;  
            
            background-color: #f1f1f1;
            border-radius: 12px;
            padding: 10px 0px;
        }
        .containers {
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .submit-button {
            width: calc(100% - 20px); /* Adjusted width to include padding */
            margin: 10px;
            padding: 10px ;
            font-size: 16px;
            color: #fff;
            background-color: #754f33;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
            transition: transform 0.3s ease;

        }
        .submit-button:hover {
            background-color: #93673e; 
            transform: translateY(-2px);
            
        }
        #drpbtn{
            padding-right: 35px;
            padding: 10px;
            color: #654528;
            background-color:#ebdcd1;
            
        }
        #selected{
            border-radius: 10px;
            width: 275px;
            margin: 0px;
            padding: 10px 0px 10px 5px;
            margin-left: 10px;
            color: #654528;
            background-color: #ebdcd1;
            font-family:Arial, Helvetica, sans-serif;


        }
        .dropbtn {
            margin-right: 10px;
            background-color: #754f33; /* Brown color */
            color: white;
            font-size: 16px;
            border: none;
            cursor: pointer;
            border-radius: 10px;
            transition: background-color 0.3s ease;

        }             
        .dropbtn:hover, .dropbtn:focus {
            background-color: #654528; /* Darker brown color */
        }              
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            max-height: 200px; /* Set a maximum height for the dropdown content */
            overflow-y: auto;
            border-radius: 8px;
            transition: all 1s ease;
        }                
        .dropdown-content a {
            transition: all 1s ease;

            color: #654528;
            padding: 12px 10px;
            text-decoration: none;
            display: block;
            border-radius: 8px;
            font-family: Arial, Helvetica, sans-serif;
        }                
        .dropdown-content a:hover {background-color: #f1f1f1;}             
        .dropdown:hover .dropdown-content {display: block;}               
        .dropdown:hover .dropbtn {background-color: #654528;}
        
        .details{
            margin:  10px 0px 10px 10px;
            padding-left: 20px;
            font-family:Arial, Helvetica, sans-serif;

        }                   
        #drop{
            display: flex;
            margin-left: 10px;
            padding-left: 10px;
            margin: 0px;
            align-content:space-between;
        }    
        #map {
            height: 400px;
            width: 75%;
            margin: 20px 25px;
            border-radius: 20px;
            text-align: center;
        }

        .data{
            margin: 5px 10px;
            padding: 1px;
            border-radius: 10px;
            width: 429px;
            background-color: #ebdcd1;
        }





        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            margin: 10px 0;
            background: #754f33; /* Brown color */
            border-radius: 13px;
            border: 0.2px solid #010101;
            color: #ffffff;
        }


        input[type="range"]::-webkit-slider-runnable-track {
            width: 100%;
            height: 8.4px;
            cursor: pointer;
            background: #754f33; /* Brown color */
            border-radius: 13px;
            border: 0.2px solid #010101;
        }

        input[type="range"]::-ms-fill-lower {
            background: #754f33; /* Brown color */
            border: 0.2px solid #010101;
            border-radius: 2.6px;
        }

        input[type="range"]::-webkit-slider-thumb {
            border: 2px solid #754f33;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #ebdcd1; /* Brown color */
            cursor: pointer;
            -webkit-appearance: none;
            margin-top: -6px;
        }


p{
    font-size: 15px;
}


label,a{
    font-size: 15px;

}



    </style>
</head>
<body onload="changePhoto()">
 
    <header id="Header">
        <div id = 'mySidebar' class = 'sidebar'>
            <a href = 'javascript:void(0)' class = 'close' onclick = "closeNav()">x</a>
            <a href = "LandingPageOut.html">About</a>
            <a href = "MainPage.html">In Between</a>
            <a href = "ExplorePage.html">Area-Specific</a>
            <a href = "searchUsers.html">Search Users</a>
            <a href = "chatWithUs.html">Need Help?</a>
            <a href = "FAQ_Page.html">FAQ</a>
            <a href = "feedbackPage.html">Feedback</a>
        </div>
        <div class = "header">
            <div id ="hamburger" >
                <button class ='open' onclick = "openNav()">&#9776;</button>
            </div>
            <h1 id="Brand">In Between</h1>

            <div class="profile">
                <p id="profileName"> <p>
                <p id="profileTag"></p>
            </div>

            <div class="dropdownL">
                    <a href="#" disabled><img src="" id="profile-icon"></a>
                <div class="dropdown-contentL">
                    <a href="LogInPage.html"  >Log Out</a>

                </div>
            </div>


        </div>
    </header>

    <h2 style="font-family:Cambria;"> Find Places near the Location <h2>
        <hr style = "border:1px solid rgb(138,111,2)">

    <div class="text-field-containerS">
        <div class="dropdown">
            <div id="drop">
                <button id="drpbtn" class="dropbtn">Select Category</button>
                <p id="selected" class="dropbtn">Select: </p>
            </div>
            <div class="dropdown-content">
                <a href="#" onfocus="choose('Restaurant','restaurant')" >Restaurants</a>
                <a href="#" onfocus="choose('Cafe','cafe')">Cafe</a>
                <a href="#" onfocus="choose('Museum','museum')">Museum</a>
                <a href="#" onfocus="choose('Shopping Mall','shopping_mall')">Shopping Mall</a>
                <a href="#" onfocus="choose('Supermarket','supermarket')">Supermarket</a>
                <a href="#" onfocus="choose('Tourist attraction','tourist_attraction')">Tourist attraction</a>
                <a href="#" onfocus="choose('Library','library')">Library</a>
                <a href="#" onfocus="choose('Bakery','bakery')">Bakery</a>
                <a href="#" onfocus="choose('Amusement park','amusement_park')">Amusement park</a>
                <a href="#" onfocus="choose('Movie Theater','movie_theater')">Movie Theater</a>
                <a href="#" onfocus="choose('Church','church')">Church</a>
                <a href="#" onfocus="choose('Hindu Temple','hindu_temple')">Hindu Temple</a>
            </div>
        </div>
        <label id="values" for="radius">Radius (in meters): <span id="radiusValue">1000</span></label>
        <input type="range" id="radius" onchange="rad()" name="radius" min="0" max="5000" value="1000">
        <button class="submit-button" id="searchButton" onclick="searchNearby()">Search Nearby Places</button>
        <div class="data">
            <p class="details" id="distance">Distance: </p>
            <p class="details" id="duration">Estimated Duration: </p>
        </div>
    </div>

    <center>
        <div id="map"></div>
    </center>


    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="footer-col">
                    <h4> Company </h4>
                    <ul>
                        <li id="links" ><a href='LandingPageOut.html' disabled>About us</a></li>
                        <li id="links"><a href='#' disabled> Our Services</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4> Policy </h4>
                    <ul>
                        <li id="links"><a href='privacyPolicy.html'>Privacy Policy</a></li>
                        <li id="links"><a href='#' disabled> Affiliate Program</a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4> Get Help</h4>
                    <ul>
                        <li id="links"><a href='FAQ_Page.html'> FAQ </a></li>
                        <li id="links"><a href='chatWithUs.html'>  Chat with Us </a></li>
                    </ul>
                </div>
                <div class="footer-col">
                    <h4> follow us </h4>
                    <div class="social-links">
                        <a href='#'><i class="fab fa-facebook-f"></i></a>
                        <a href='#'><i class="fab fa-twitter"></i></a>
                        <a href='#'><i class="fab fa-instagram"></i></a>
                        <a href='#'><i class="fab fa-linkedin-in"></i></a>
                    </div>
  
                </div>
                    <h1 id="copyright">Copyright Â© <strong id="logoF">InBetween</strong></h1>
            </div>
        </div>
    </footer>
  


<script>
        let placeType;
        let map, currentLocation;
            
        let markers = [];
        let directionsService;
        let directionsRenderer;

        function rad() {
            document.getElementById("radiusValue").innerText = document.getElementById("radius").value;
        }

        function initMap() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    currentLocation = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude
                    };

                    map = new google.maps.Map(document.getElementById('map'), {
                        center: currentLocation,
                        zoom: 16
                    });

                    new google.maps.Marker({
                        position: currentLocation,
                        title: 'Your Location',
                        map: map
                    });

                    directionsService = new google.maps.DirectionsService();
                    directionsRenderer = new google.maps.DirectionsRenderer({
                        map: map,
                        polylineOptions: {strokeColor: '#754f33'} 
                    });
                    directionsRenderer.setMap(map);

                }, function () {
                    alert('Error: The Geolocation service failed.');
                });
            }

            document.getElementById('searchButton').addEventListener('click', searchNearby);
        }

        function searchNearby() {
            let radius = document.getElementById('radius').value;
            let request = {
                location: currentLocation,
                radius: radius,
                type: placeType,
            };

            let service = new google.maps.places.PlacesService(map);
            service.nearbySearch(request, callback);
        }

        function callback(results, status) {
            if (status == google.maps.places.PlacesServiceStatus.OK) {
                clearMarkers();
                for (let i = 0; i < results.length; i++) {
                    createMarker(results[i]);
                }
                fitMarkersBounds();
            }
        }

        function createMarker(place) {
            let marker = new google.maps.Marker({
                map: map,
                position: place.geometry.location
            });
            markers.push(marker);

            google.maps.event.addListener(marker, 'click', function () {
                const service = new google.maps.places.PlacesService(map);
                service.getDetails({
                    placeId: place.place_id
                }, function (place, status) {
                    if (status === google.maps.places.PlacesServiceStatus.OK) {
                        const infowindow = new google.maps.InfoWindow({
                            content: `<div><strong>${place.name}</strong><br>Rating: ${place.rating}<br>Phone: ${place.formatted_phone_number}<br>Reviews: ${place.reviews.map(review => `<li>${review.text}</li>`).join('')}</div>`
                        });
                        infowindow.open(map, marker);
                    }
                });

                let request = {
                    origin: currentLocation,
                    destination: marker.getPosition(),
                    travelMode: 'DRIVING',
                };

                directionsService.route(request, function (response, status) {
                    if (status === 'OK') {
                        directionsRenderer.setDirections(response);
                        let route = response.routes[0];
                        let distance = route.legs[0].distance.text;
                        let duration = route.legs[0].duration.text;

                        document.getElementById('distance').innerText = `Distance: ${distance}`;
                        document.getElementById('duration').innerText = `Estimated Duration: ${duration}`;
                    } else {
                        alert('Error: ' + status);
                    }
                });
            });
        }

        function clearMarkers() {
            for (let i = 0; i < markers.length; i++) {
                markers[i].setMap(null);
            }
            markers = [];
        }

        function fitMarkersBounds() {
            let bounds = new google.maps.LatLngBounds();
            for (let i = 0; i < markers.length; i++) {
                bounds.extend(markers[i].getPosition());
            }
            map.fitBounds(bounds);
        }


        function choose(t, r) {
            document.getElementById("selected").innerText = "Select: " + t;
            placeType = r;
        }
    </script>

    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCn8IQ94FYOnNQAI5UcuNrIxJjkMbz5z-Y&libraries=places&callback=initMap"></script>
</body>
</html>
